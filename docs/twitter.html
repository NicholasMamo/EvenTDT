

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="The tweet collection or reading functionality of EvenTDT" name="description" />
<meta content="Python, TDT, Twitter" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>8. Twitter &mdash; EvenTDT 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/eventdt.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="9. Consumers" href="consumers.html" />
    <link rel="prev" title="7. Summarization" href="summarization.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> EvenTDT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="config.html">0. Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">1. Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="vsm.html">2. Vector Space Model (VSM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp.html">3. Natural Language Processing (NLP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="wikinterface.html">4. Wikinterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="apd.html">5. Automatic Participant Detection (APD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tdt.html">6. Topic Detection and Tracking (TDT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="summarization.html">7. Summarization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. Twitter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-twitter.listeners">Listeners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-twitter.listeners.tweet_listener">Tweet Listener</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-twitter.listeners.queued_tweet_listener">Queued Tweet Listener</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-twitter.file">Readers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="consumers.html">9. Consumers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.html">10. Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="ate.html">11. Automatic Term Extraction (ATE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">12. Other</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EvenTDT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>8. Twitter</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/twitter.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
    <div class="section" id="twitter">
<h1>8. Twitter<a class="headerlink" href="#twitter" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-twitter"></span><p>The Twitter package is used to facilitate collecting, reading and processing tweet corpora.
At the package-level there are functions to help with general processing tasks.</p>
<dl class="function">
<dt id="twitter.extract_timestamp">
<code class="sig-name descname">extract_timestamp</code><span class="sig-paren">(</span><em class="sig-param">tweet</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.extract_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the timestamp from the given tweet.
This function looks for the timestamp in one of two fields:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">timestamp_ms</span></code>: always present in the top-level tweets, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">created_at</span></code>: present in <cite>retweeted_status</cite>, for example.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tweet</strong> (<em>dict</em>) – The tweet from which to extract the timestamp.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The timestamp of the tweet.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>KeyError</strong> – When no timestamp field can be found.</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="module-twitter.listeners">
<span id="listeners"></span><h2>Listeners<a class="headerlink" href="#module-twitter.listeners" title="Permalink to this headline">¶</a></h2>
<p>Listeners are used to download corpora in real-time.
These classes automatically connect to the APIs to fetch tweets based on a number of parameters.</p>
<div class="section" id="module-twitter.listeners.tweet_listener">
<span id="tweet-listener"></span><h3>Tweet Listener<a class="headerlink" href="#module-twitter.listeners.tweet_listener" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> is based on Tweepy’s <code class="xref py py-class docutils literal notranslate"><span class="pre">tweepy.stream.StreamListener</span></code>.
This listener receives tweets and saves them to file.
It is not responsible for filtering tweets; that is, the stream settings are set beforehand, and the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> only receives the output from this stream.</p>
<p>The <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> accumulates tweets and periodically writes them to a file.
When the stream closes, it writes the last tweets to the file.</p>
<p>Tweet objects include a lot of attributes, which may not always be required and result in large corpora.
Therefore this listener also supports attribute filtering, which removes needless data from tweets before saving them to file.</p>
<dl class="class">
<dt id="twitter.listeners.tweet_listener.TweetListener">
<em class="property">class </em><code class="sig-name descname">TweetListener</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">max_time=3600</em>, <em class="sig-param">attributes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.tweet_listener.TweetListener" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> handles the tweets that the stream sends.
It does not configure the stream, but only processes the tweets it sends.</p>
<p>The <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a>’s state stores the file pointer where to save files.
By default, it accumulates tweets until the <code class="docutils literal notranslate"><span class="pre">THRESHOLD</span></code> constant is reached.
At that point, the accumulated tweets are saved to file.
In the meantime, it stores the tweets in the list of <code class="docutils literal notranslate"><span class="pre">tweets</span></code>.</p>
<p>Although listeners do not control the stream’s specifications, they can stop it.
The <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> receives the <code class="docutils literal notranslate"><span class="pre">max_time</span></code> parameter which specifies, in seconds, the time to spend receiving tweets.
The <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener.on_data" title="twitter.listeners.tweet_listener.TweetListener.on_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_data()</span></code></a> function stops the stream when it receives a tweet after this time expires.
When it stops the stream, it saves any pending tweets to file.</p>
<p>Tweet objects contain many attributes, some of which may not be needed, but which create large corpora.
For example, feature-pivot algorithms that rely only on volume do not need anything except the tweet ID and the timestamp.
Therefore the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> also stores the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> variable.
This represents a list of tweet attributes to save to file.
If it is not given, the tweets are stored without any filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>THRESHOLD</strong> (<em>int</em>) – The number of tweets to accumulate before writing them to file.</p></li>
<li><p><a class="reference internal" href="#module-twitter.file" title="twitter.file"><strong>file</strong></a> (<em>file</em>) – The opened file pointer where to write the tweets.</p></li>
<li><p><strong>tweets</strong> (<em>list</em>) – The list of read tweets that have not been written to file yet.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend receiving tweets.
When this time expires, the listener instructs the stream to stop accepting tweets.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The timestamp when the listener started waiting for tweets.
This variable is used to calculate the time the listener has spent receiving tweets.</p></li>
<li><p><strong>attributes</strong> (<em>list of str</em><em> or </em><em>None</em>) – The attributes to save from each tweet.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the entire tweet objects are saved.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="twitter.listeners.tweet_listener.TweetListener.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">f</em>, <em class="sig-param">max_time=3600</em>, <em class="sig-param">attributes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.tweet_listener.TweetListener.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the listener.
Simultaneously set the file and the list of tweets.
By default, the stream continues processing for an hour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>file</em>) – The opened file pointer where to write the tweets.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend receiving tweets.
When this time expires, the listener instructs the stream to stop accepting tweets.</p></li>
<li><p><strong>attributes</strong> (<em>list of str</em><em> or </em><em>None</em>) – The attributes to save from each tweet.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the entire tweet objects are saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.tweet_listener.TweetListener.flush">
<code class="sig-name descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.tweet_listener.TweetListener.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush the tweets to file.
Data is saved as a string to file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point, tweets are already JSON dictionaries and have a newline character at the end.
Since each tweet is a string representing a line, this function only concatenates these lines together.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.tweet_listener.TweetListener.on_data">
<code class="sig-name descname">on_data</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.tweet_listener.TweetListener.on_data" title="Permalink to this definition">¶</a></dt>
<dd><p>When the listener receives tweets, add them to a list.
If there are many tweets, save them to file and reset the list of tweets.</p>
<p>When the function adds tweets to the list, they are strings, ready to be saved by the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener.flush" title="twitter.listeners.tweet_listener.TweetListener.flush"><code class="xref py py-func docutils literal notranslate"><span class="pre">flush()</span></code></a> function.
That means they are JSON-encoded strings with a newline character at the end.</p>
<p>This function also checks if the listener has been listening for tweets for a long time.
If it exceeds the <code class="docutils literal notranslate"><span class="pre">max_time</span></code>, the function returns <code class="docutils literal notranslate"><span class="pre">False</span></code> so that the stream ends.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>str</em>) – The received data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A boolean indicating if the listener has finished reading tweets.
It is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> normally.
When the elapsed time exceeds the <code class="docutils literal notranslate"><span class="pre">max_time</span></code> parameter, the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> returns <code class="docutils literal notranslate"><span class="pre">False</span></code>.
This instructs the stream to stop receiving tweets.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.tweet_listener.TweetListener.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param">tweet</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.tweet_listener.TweetListener.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the given tweet using the attributes specified when creating the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a>.
If no attributes were given, the tweet’s attributes are all retained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tweet</strong> (<em>dict</em>) – The tweet attributes as a dictionary.
The keys are the attribute names and the values are the data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tweet as a dictionary with only the required attributes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.tweet_listener.TweetListener.on_error">
<code class="sig-name descname">on_error</code><span class="sig-paren">(</span><em class="sig-param">status</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.tweet_listener.TweetListener.on_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Print any errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>status</strong> (<em>str</em>) – The error status.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-twitter.listeners.queued_tweet_listener">
<span id="queued-tweet-listener"></span><h3>Queued Tweet Listener<a class="headerlink" href="#module-twitter.listeners.queued_tweet_listener" title="Permalink to this headline">¶</a></h3>
<p>Like the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a>, the <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuedTweetListener</span></code></a> is based on Tweepy and its <code class="xref py py-class docutils literal notranslate"><span class="pre">tweepy.stream.StreamListener</span></code>.
However, it differs from the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> because it does not save tweets to a file, but it adds them to a <a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>.
This listener is preferrable when there is no need to save tweets as they are processed as soon as they arrive.
Therefore the <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuedTweetListener</span></code></a> is designed to work out of the box with <a class="reference internal" href="consumers.html#id1"><span class="std std-ref">consumers</span></a>.</p>
<dl class="class">
<dt id="twitter.listeners.queued_tweet_listener.QueuedTweetListener">
<em class="property">class </em><code class="sig-name descname">QueuedTweetListener</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">max_time=3600</em>, <em class="sig-param">attributes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuedTweetListener</span></code></a> handles the tweets that the stream sends.
It does not configure the stream, but only processes the tweets it sends.</p>
<p>The <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuedTweetListener</span></code></a> differs from the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> because it adds these tweets to a <a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a> instead of saving them to a file
Therefore the class maintains the <a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a> as part of its state.</p>
<p>Although listeners do not control the stream’s specifications, they can stop it.
The <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuedTweetListener</span></code></a> receives the <code class="docutils literal notranslate"><span class="pre">max_time</span></code> parameter which specifies, in seconds, the time to spend receiving tweets.
The <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener.on_data" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener.on_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">on_data()</span></code></a> function stops the stream when it receives a tweet after this time expires.</p>
<p>Like the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a>, the <a class="reference internal" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener" title="twitter.listeners.queued_tweet_listener.QueuedTweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuedTweetListener</span></code></a> can also filter tweets by removing certain attributes.
The attributes that should be retained are specified using the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> parameter and are saved as part of the class’ state.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="consumers.html#module-queues.queue" title="queues.queue"><strong>queue</strong></a> (<a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>) – The queue to which to add incoming tweets.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend reading the file.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The timestamp when the listener started waiting for tweets.</p></li>
<li><p><strong>attributes</strong> (<em>list of str</em><em> or </em><em>None</em>) – The attributes to save from each tweet.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the entire tweet objects are saved.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="twitter.listeners.queued_tweet_listener.QueuedTweetListener.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">max_time=3600</em>, <em class="sig-param">attributes=None</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the listener.
Simultaneously set the queue.
By default, the stream continues processing for an hour.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queue</strong> – The queue to which to add incoming tweets.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend reading the file.</p></li>
<li><p><strong>attributes</strong> (<em>list of str</em><em> or </em><em>None</em>) – The attributes to save from each tweet.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> is given, the entire tweet objects are saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.queued_tweet_listener.QueuedTweetListener.on_data">
<code class="sig-name descname">on_data</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener.on_data" title="Permalink to this definition">¶</a></dt>
<dd><p>When the listener receives tweets, add them to the queue immediately after filtering out any attributes that are not required.
When the function adds tweets to the list, they are dictionaries, ready to be processed by the consumer.</p>
<p>This function also checks if the listener has been listening for tweets for a long time.
If it exceeds the <code class="docutils literal notranslate"><span class="pre">max_time</span></code>, the function returns <code class="docutils literal notranslate"><span class="pre">False</span></code> so that the stream ends.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>str</em>) – The received data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A boolean indicating if the listener has finished reading tweets.
It is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> normally.
When the elapsed time exceeds the <code class="docutils literal notranslate"><span class="pre">max_time</span></code> parameter, the <a class="reference internal" href="#twitter.listeners.tweet_listener.TweetListener" title="twitter.listeners.tweet_listener.TweetListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">TweetListener</span></code></a> returns <code class="docutils literal notranslate"><span class="pre">False</span></code>.
This instructs the stream to stop receiving tweets.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.queued_tweet_listener.QueuedTweetListener.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param">tweet</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the given tweet using the attributes.
If no attributes are given, the tweet’s attributes are all retained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tweet</strong> (<em>dict</em>) – The tweet attributes as a dictionary.
The keys are the attribute names and the values are the data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tweet as a dictionary with only the required attributes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.listeners.queued_tweet_listener.QueuedTweetListener.on_error">
<code class="sig-name descname">on_error</code><span class="sig-paren">(</span><em class="sig-param">status</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.listeners.queued_tweet_listener.QueuedTweetListener.on_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Print any errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>status</strong> (<em>str</em>) – The error status.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-twitter.file">
<span id="readers"></span><h2>Readers<a class="headerlink" href="#module-twitter.file" title="Permalink to this headline">¶</a></h2>
<p>A reader does not collect tweets from Twitter, but reads them from a file.
The queue and file are given in the constructor.
Reading can be started asynchronously using the <code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code> function.</p>
<dl class="class">
<dt id="twitter.file.FileReader">
<em class="property">class </em><code class="sig-name descname">FileReader</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">f</em>, <em class="sig-param">max_lines=-1</em>, <em class="sig-param">max_time=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.FileReader" title="Permalink to this definition">¶</a></dt>
<dd><p>The file reader reads tweets from a file and outputs its contents to a queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="consumers.html#module-queues.queue" title="queues.queue"><strong>queue</strong></a> (<a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>) – The queue to which to add tweets.</p></li>
<li><p><a class="reference internal" href="#module-twitter.file" title="twitter.file"><strong>file</strong></a> (<em>file</em>) – The opened file pointer which contains the tweets.</p></li>
<li><p><strong>max_lines</strong> (<em>int</em>) – The maximum number of lines to read.
If the number is negative, it is ignored.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend reading from the file.
The time is taken from tweets’ <cite>created_at</cite> attribute.
If the number is negative, it is ignored.</p></li>
<li><p><strong>active</strong> (<em>bool</em>) – A boolean indicating whether the reader is still reading data.</p></li>
<li><p><strong>stopped</strong> (<em>bool</em>) – A boolean indicating whether the consumer has finished processing.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="twitter.file.FileReader.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">f</em>, <em class="sig-param">max_lines=-1</em>, <em class="sig-param">max_time=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.FileReader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the listener.
Simultaneously set the queue, the list of tweets and the number of processed tweets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queue</strong> (<a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>) – The queue to which to add the tweets.</p></li>
<li><p><strong>f</strong> (<em>file</em>) – The opened file from where to read the tweets.</p></li>
<li><p><strong>max_lines</strong> (<em>int</em>) – The maximum number of lines to read.
If the number is negative, it is ignored.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend reading from the file.
The time is taken from tweets’ <cite>created_at</cite> attribute.
If the number is negative, it is ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.file.FileReader.read">
<em class="property">abstract async </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.FileReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the file and add each line as a dictionary to the queue.</p>
</dd></dl>

<dl class="method">
<dt id="twitter.file.FileReader.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.FileReader.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a flag to stop accepting new objects.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Contrary to the name of the function, the function sets the <cite>active</cite> flag, not the <cite>stopped</cite> flag.
This function merely asks that the consumer stops accepting new objects for processing.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="twitter.file.FileReader.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#twitter.file.FileReader.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-twitter.file.simulated_reader"></span><p>A simulated file listener reads data from a file and adds it to a queue.
It pretends that the event is ongoing, and adds data to the queue according to when they happened.
Therefore high-volume periods enqueue a lot of tweets to the queue.
Low-volume periods enqueue fewer tweets to the queue.</p>
<dl class="class">
<dt id="twitter.file.simulated_reader.SimulatedFileReader">
<em class="property">class </em><code class="sig-name descname">SimulatedFileReader</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">f</em>, <em class="sig-param">max_lines=-1</em>, <em class="sig-param">max_time=-1</em>, <em class="sig-param">speed=1</em>, <em class="sig-param">skip_lines=0</em>, <em class="sig-param">skip_time=0</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.simulated_reader.SimulatedFileReader" title="Permalink to this definition">¶</a></dt>
<dd><p>The simulated file listener reads data from a file and adds it to a queue.
This works like a simulation, as if the event was happening at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>speed</strong> (<em>int</em>) – The reading speed as a function of time.
If it is set to 0.5, for example, the event progresses at half the speed.
If it is set to 2, the event progresses at double the speed.</p>
</dd>
</dl>
<dl class="method">
<dt id="twitter.file.simulated_reader.SimulatedFileReader.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">f</em>, <em class="sig-param">max_lines=-1</em>, <em class="sig-param">max_time=-1</em>, <em class="sig-param">speed=1</em>, <em class="sig-param">skip_lines=0</em>, <em class="sig-param">skip_time=0</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.simulated_reader.SimulatedFileReader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the reader and skip any required lines or time from the file.
By default, the file reader skips no lines or time.
The skip rate can be set to sample the file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of lines and seconds that are skipped depend on the largest number.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The maximum number of lines and seconds is exclusive.
That means that if either are 0, no tweets are read.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queue</strong> – The queue to which to add incoming tweets.</p></li>
<li><p><strong>f</strong> (<em>file</em>) – The opened file from where to read the tweets.</p></li>
<li><p><strong>max_lines</strong> (<em>int</em>) – The maximum number of lines to read.
If the number is negative, it is ignored.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend reading from the file.
The maximum time is understood to be i nterms of the corpus’ time.
The time is taken from tweets’ <cite>created_at</cite> attribute.
If the number is negative, it is ignored.</p></li>
<li><p><strong>speed</strong> (<em>int</em>) – The reading speed, considered to be a function of time.
If it is set to 0.5, for example, the event progresses at half the speed.
If it is set to 2, the event progresses at double the speed.</p></li>
<li><p><strong>skip_lines</strong> (<em>int</em>) – The number of lines to skip from the beginning of the file.</p></li>
<li><p><strong>skip_time</strong> (<em>int</em>) – The number of seconds to skip from the beginning of the file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When the speed is zero or negative.</p></li>
<li><p><strong>ValueError</strong> – When the number of lines to skip is not an integer.</p></li>
<li><p><strong>ValueError</strong> – When the number of lines to skip is negative.</p></li>
<li><p><strong>ValueError</strong> – When the number of seconds to skip is negative.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.file.simulated_reader.SimulatedFileReader.skip">
<code class="sig-name descname">skip</code><span class="sig-paren">(</span><em class="sig-param">lines</em>, <em class="sig-param">time</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.simulated_reader.SimulatedFileReader.skip" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip a number of lines from the file.
This virtually just reads lines without storing them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of lines and seconds that are skipped depend on the largest number.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> (<em>int</em>) – The number of lines to skip.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of seconds to skip from the beginning of the file.
The time is taken from tweets’ <cite>created_at</cite> attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.file.simulated_reader.SimulatedFileReader.read">
<em class="property">async </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.simulated_reader.SimulatedFileReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the file.
Tweets are added as a dictionary to the queue.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-twitter.file.staggered_reader"></span><p>The staggered file reader reads lines a few at a time.
This reader allows a steady stream of tweets to be read and processed.</p>
<dl class="class">
<dt id="twitter.file.staggered_reader.StaggeredFileReader">
<em class="property">class </em><code class="sig-name descname">StaggeredFileReader</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">f</em>, <em class="sig-param">max_lines=-1</em>, <em class="sig-param">max_time=-1</em>, <em class="sig-param">rate=1</em>, <em class="sig-param">skip_rate=0</em>, <em class="sig-param">skip_lines=0</em>, <em class="sig-param">skip_time=0</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.staggered_reader.StaggeredFileReader" title="Permalink to this definition">¶</a></dt>
<dd><p>The staggered file reader reads lines a few at a time, then stops and waits.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rate</strong> (<em>float</em>) – The number of lines to read per second.</p></li>
<li><p><strong>skip_rate</strong> (<em>int</em>) – The number of lines to skip for each line read.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="twitter.file.staggered_reader.StaggeredFileReader.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">f</em>, <em class="sig-param">max_lines=-1</em>, <em class="sig-param">max_time=-1</em>, <em class="sig-param">rate=1</em>, <em class="sig-param">skip_rate=0</em>, <em class="sig-param">skip_lines=0</em>, <em class="sig-param">skip_time=0</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.staggered_reader.StaggeredFileReader.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the reader and skip any required lines or time from the file.
By default, the file reader skips no lines or time.
The skip rate can be set to sample the file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of lines and seconds that are skipped depend on the largest number.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The maximum number of lines and seconds is exclusive.
That means that if either are 0, no tweets are read.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queue</strong> (<a class="reference internal" href="consumers.html#queues.queue.Queue" title="queues.queue.Queue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>) – The queue to which to add the tweets.</p></li>
<li><p><strong>f</strong> (<em>file</em>) – The opened file from where to read the tweets.</p></li>
<li><p><strong>max_lines</strong> (<em>int</em>) – The maximum number of lines to read.
If the number is negative, it is ignored.</p></li>
<li><p><strong>max_time</strong> (<em>int</em>) – The maximum time in seconds to spend reading from the file.
The time is taken from tweets’ <cite>created_at</cite> attribute.
If the number is negative, it is ignored.</p></li>
<li><p><strong>rate</strong> (<em>float</em>) – The number of lines to read per second.</p></li>
<li><p><strong>skip_rate</strong> (<em>int</em>) – The number of lines to skip for each line read.</p></li>
<li><p><strong>skip_lines</strong> (<em>int</em>) – The number of lines to skip from the beginning of the file.</p></li>
<li><p><strong>skip_time</strong> (<em>int</em>) – The number of seconds to skip from the beginning of the file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – When the rate is not an integer.</p></li>
<li><p><strong>ValueError</strong> – When the rate is zero or negative.</p></li>
<li><p><strong>ValueError</strong> – When the number of lines to skip is not an integer.</p></li>
<li><p><strong>ValueError</strong> – When the number of lines to skip is negative.</p></li>
<li><p><strong>ValueError</strong> – When the number of seconds to skip is negative.</p></li>
<li><p><strong>ValueError</strong> – When the number of lines to skip after each read is not an integer.</p></li>
<li><p><strong>ValueError</strong> – When the number of lines to skip after each read is negative.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.file.staggered_reader.StaggeredFileReader.skip">
<code class="sig-name descname">skip</code><span class="sig-paren">(</span><em class="sig-param">lines</em>, <em class="sig-param">time</em><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.staggered_reader.StaggeredFileReader.skip" title="Permalink to this definition">¶</a></dt>
<dd><p>Skip a number of lines from the file.
This virtually just reads lines without storing them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of lines and seconds that are skipped depend on the largest number.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lines</strong> (<em>int</em>) – The number of lines to skip.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of seconds to skip from the beginning of the file.
The time is taken from tweets’ <cite>created_at</cite> attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="twitter.file.staggered_reader.StaggeredFileReader.read">
<em class="property">async </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#twitter.file.staggered_reader.StaggeredFileReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the file.
Tweets are added as a dictionary to the queue.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="consumers.html" class="btn btn-neutral float-right" title="9. Consumers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="summarization.html" class="btn btn-neutral float-left" title="7. Summarization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Nicholas Mamo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>